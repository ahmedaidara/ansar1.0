<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>مصحف الحفظ والتلاوة</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
       :root {
      --primary-color: #073332;
      --secondary-color: #073332;
      --accent-color: #9b9c28;
      --bg-color: #073332;
      --text-color: #ffffff;
    }
    
    body {
      font-family: 'Amiri', serif;
      background-color: var(--secondary-color);
      color: var(--text-color);
      overflow-x: hidden;
    }
    
    .islamic-pattern {
      background-image: url('https://www.transparenttextures.com/patterns/arabesque.png');
      opacity: 0.05;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      z-index: 0;
    }
    /* Nouveau style pour les boutons de la page d'accueil */
    .main-btn {
    background: linear-gradient(135deg, #1f4a49 0%, #073332 100%);
    color: white;
    padding: 1.5rem;
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    border: 2px solid rgba(255, 255, 255, 0.1);
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: 100px;
  }

  .main-btn .content {
    display: flex;
    align-items: center;
    gap: 1rem;
  }

  .main-btn i {
    font-size: 2rem;
    margin-left: 1rem; /* À droite en RTL */
  }

  .main-btn .title {
    font-size: 1.5rem;
    font-weight: bold;
    text-align: right;
  }
    .main-btn .title {
      font-size: 1.5rem;
      font-weight: bold;
    }
    .verse {
      line-height: 2.5;
      margin-bottom: 1.5rem;
      position: relative;
      transition: all 0.3s ease;
    }
.french-surah-title {
    background: linear-gradient(to right, #e1c174, #d4af37);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  font-size: 1.8rem; /* Taille augmentée (auparavant 2rem) */
  font-weight: bold;
  text-align: center;
  margin: 0 0 2rem 0; /* Marge augmentée en bas */
  padding-bottom: 0.5rem;
  border-bottom: 2px solid #e1c174;
  text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.3);
  letter-spacing: 1px; /* Espacement des lettres amélioré */
}
    #surah-text {
      padding-right: 1.5rem;
      padding-left: 1.5rem;
    }
    
    .verse-number {
      color: #009513;
      font-size: 0.8em;
      vertical-align: super;
    }
    
    .bismillah {
      font-size: 2rem;
      font-weight: bold;
      text-align: center;
      margin: 2rem 0;
      color: #e1c174;
    }
    
    .nav-btn {
      transition: all 0.3s ease;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    
    .nav-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
    }
    
    .player-controls {
      background: linear-gradient(135deg, #f5f7fa 0%, #e4e8eb 100%);
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    }
    
    .progress-container {
      height: 6px;
      background-color: #e0e0e0;
      border-radius: 3px;
      cursor: pointer;
    }
    
    #surah-list > div, #french-surah-list > div {
      background-color: #0f3e3d;
      padding: 1rem;
      border-radius: 0.5rem;
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.25),
                  0 8px 10px -6px rgba(0, 0, 0, 0.1);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      transform: translateY(0);
    }
    
    #surah-list > div:hover, #french-surah-list > div:hover {
      background-color: #1f4a49;
    }
    
    .progress-bar {
      height: 100%;
      background: linear-gradient(90deg, var(--primary-color) 0%, #4facfe 100%);
      border-radius: 3px;
      width: 0%;
      transition: width 0.1s linear;
    }
    
    .text-size-btn {
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      background-color: var(--primary-color);
      color: white;
      cursor: pointer;
    }
    
    @media (max-width: 768px) {
      .verse {
        font-size: 1.5rem;
        line-height: 2;
      }
      .bismillah {
        font-size: 1.75rem;
      }
    }
    /* Supprimez ou modifiez ces styles */
    #french-surah-content .header {
      /* Remplacez le sticky par : */
      position: relative;
      top: auto;
      background-color: var(--secondary-color);
      padding: 1rem 0;
      margin-bottom: 1.5rem;
    }
    .audio-surah-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 1rem;
      background-color: #0f3e3d;
      border-radius: 0.5rem;
      margin-bottom: 0.5rem;
      width: 100%;
    }
    
    .audio-surah-item button {
      padding: 0.5rem 1rem;
      background-color: var(--primary-color);
      color: white;
      border-radius: 0.5rem;
    }
    
    .progress-container-audio {
      height: 8px;
      background-color: #e0e0e0;
      border-radius: 4px;
      cursor: pointer;
      margin: 0 0.5rem;
      position: relative;
      overflow: hidden;
      display: block !important;
      width: 100%;
      min-width: 100px;
      z-index: 1;
    }
    .bismillah-french {
  font-size: 1.8rem;
  text-align: center;
  color: #e1c174;
  margin: 2rem 0;
  padding: 1rem;
  font-weight: bold;
  font-style: italic;
  border-bottom: 1px solid rgba(225, 193, 116, 0.3);
}
    .progress-bar-audio {
      height: 100%;
      background: linear-gradient(90deg, #4CAF50 0%, #8BC34A 100%);
      border-radius: 4px;
      width: 0%;
      transition: width 0.1s linear;
      display: block !important;
      position: absolute;
      top: 0;
      left: 0;
      z-index: 2;
    }
    
    .time-display {
      font-size: 0.8rem;
      color: #666;
      min-width: 40px;
      text-align: center;
    }
    
    .audio-surah-item > div {
      display: flex;
      align-items: center;
      width: 100%;
    }
    
    /* Page sections */
    .page-section {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      overflow-y: auto;
      background-color: var(--secondary-color);
      z-index: 100;
      transform: translateX(100%);
      transition: transform 0.3s ease;
      padding: 1rem;
    }
    
    .page-section.active {
      transform: translateX(0);
    }
    
    /* Main page doesn't need to be fixed */
    #main-page {
      position: relative;
      z-index: 10;
    }
    
    .hidden {
      display: none !important;
    }
    
    /* French specific styles */
    .french-verse {
      margin-bottom: 1.5rem;
      padding: 0.5rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .french-verse-number {
      background-color: var(--primary-color);
      color: white;
      border-radius: 50%;
      width: 25px;
      height: 25px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      margin-left: 0.5rem;
      font-size: 0.8rem;
    }
    
    /* Loading spinner */
    .loading-spinner {
      border: 4px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top: 4px solid #fff;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 2rem auto;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    .audio-type-btn {
  background-color: var(--primary-color);
  color: white;
  padding: 1rem;
  border-radius: 0.5rem;
  text-align: center;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  border: none;
}

.audio-type-btn:hover {
  background-color: #0f3e3d;
  transform: translateY(-2px);
  box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
}

.audio-type-btn:active {
  background-color: #073332;
  transform: translateY(0);
}
  </style>
</head>
<body class="min-h-screen relative">
  <div class="islamic-pattern"></div>
  
  <!-- Main Page -->
   <!-- Main Page -->
  <div id="main-page" class="container mx-auto px-4 py-8 relative z-10">
    <header class="text-center mb-12">
      <h1 class="text-4xl font-bold text-yellow-600 mb-4">مصحف التلاوة</h1>
      <div class="w-32 h-1 bg-yellow-600 mx-auto mb-8"></div>
    </header>

    <!-- Nouvelle navigation principale simplifiée -->
    <div class="grid grid-cols-1 gap-8 max-w-2xl mx-auto">
      <!-- Quran Reading -->
      <div onclick="showSection('surah-page')" class="main-btn">
        <i class="fas fa-book-quran"></i>
        <div class="title">القرآن الكريم</div>
      </div>
      
      <!-- Quran Listening -->
      <div onclick="showSection('audio-page')" class="main-btn">
        <i class="fas fa-headphones"></i>
        <div class="title">استماع القرآن</div>
      </div>
      
      <!-- Quran in French -->
      <div onclick="showSection('french-page')" class="main-btn">
        <i class="fas fa-language"></i>
        <div class="title">القرآن بالفرنسية</div>
      </div>
    </div>
  </div>


  <!-- Surah List Page -->
  <div id="surah-page" class="page-section">
    <div class="flex justify-between items-center mb-8">
      <button onclick="hideSection('surah-page')" class="px-4 py-2 bg-[var(--primary-color)] text-white rounded-lg hover:bg-opacity-90 transition">
        <i class="fas fa-arrow-right mr-2"></i> العودة
      </button>
      <h2 class="text-3xl font-bold text-[#9b9c28]">سور القرآن الكريم</h2>
      <div></div>
    </div>

    <div id="surah-list" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4">
      <!-- Surahs will be loaded here -->
    </div>
  </div>

  <!-- Surah Content Page -->
  <div id="surah-content" class="page-section">
  <div class="header flex justify-between items-center mb-8 bg-[var(--secondary-color)] py-4">
      <button onclick="backToList()" class="px-4 py-2 bg-[var(--primary-color)] text-white rounded-lg hover:bg-opacity-90 transition">
        <i class="fas fa-arrow-right mr-2"></i> العودة
      </button>
      
      <div class="flex items-center gap-4">
        <div id="text-size-controls" class="flex items-center gap-2">
          <button onclick="decreaseTextSize()" class="text-size-btn">
            <i class="fas fa-font"></i> -
          </button>
          <button onclick="increaseTextSize()" class="text-size-btn">
            <i class="fas fa-font"></i> +
          </button>
        </div>
        
        <h2 id="surah-title" class="text-3xl font-bold text-emerald-600 text-center"></h2>
      </div>
    </div>

    <div id="surah-text" class="text-2xl leading-loose mb-12 text-justify">
      <!-- Surah content will be loaded here -->
    </div>
  </div>

  <!-- Audio Page -->
  <div id="audio-page" class="page-section">
    <div class="flex justify-between items-center mb-8">
      <button onclick="hideSection('audio-page')" class="px-4 py-2 bg-[var(--primary-color)] text-white rounded-lg hover:bg-opacity-90 transition">
        <i class="fas fa-arrow-right mr-2"></i> العودة
      </button>
      <h2 class="text-3xl font-bold text-[#9b9c28]">تلاوات محمود خليل الحصري</h2>
      <div></div>
    </div>
    
   <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
  <button onclick="navigateToAudioType('murattal')" class="audio-type-btn">
    <div class="text-xl font-bold">مرتل - Murattal</div>
  </button>
  <button onclick="navigateToAudioType('mujawad')" class="audio-type-btn">
    <div class="text-xl font-bold">مجود - Mujawwad</div>
  </button>
  <button onclick="navigateToAudioType('hafs')" class="audio-type-btn">
    <div class="text-xl font-bold">حفص - Hafs</div>
  </button>
</div>
  </div>

  <!-- Audio Surah List Page -->
  <div id="audio-surah-page" class="page-section">
    <div class="flex justify-between items-center mb-8">
      <button onclick="hideSection('audio-surah-page')" class="px-4 py-2 bg-[var(--primary-color)] text-white rounded-lg hover:bg-opacity-90 transition">
        <i class="fas fa-arrow-right mr-2"></i> العودة
      </button>
      <h2 id="audio-surah-title" class="text-3xl font-bold text-[#9b9c28]"></h2>
      <div></div>
    </div>
    
    <div id="audio-surah-list" class="grid grid-cols-1 gap-4">
      <!-- Audio surah list will be loaded here -->
    </div>
  </div>

  <!-- French Quran Page -->
  <div id="french-page" class="page-section">
    <div class="flex justify-between items-center mb-8">
      <button onclick="hideSection('french-page')" class="px-4 py-2 bg-[var(--primary-color)] text-white rounded-lg hover:bg-opacity-90 transition">
        <i class="fas fa-arrow-right mr-2"></i> Retour
      </button>
      <h2 class="text-3xl font-bold text-[#9b9c28]">Le Coran en français</h2>
      <div></div>
    </div>
    
    <div id="french-surah-list" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4">
      <!-- French surah list will be loaded here -->
    </div>
  </div>

  <!-- French Surah Content Page -->
<div id="french-surah-content" class="page-section">
    <!-- En-tête défilant -->
    <div class="header flex justify-between items-center">
      <button onclick="hideSection('french-surah-content')" class="px-4 py-2 bg-[var(--primary-color)] text-white rounded-lg hover:bg-opacity-90 transition">
        <i class="fas fa-arrow-right mr-2"></i> Retour
      </button>
      <h2 id="french-surah-title" class="french-surah-title"></h2>
    </div>
    
    <!-- Contenu défilant -->
    <div id="french-surah-text" class="text-xl leading-loose text-justify p-4">
      <!-- Contenu de la sourate -->
    </div>
  </div>

  <script>
    // Variables globales
    let currentAudio = null;
    let currentSurah = null;
    let currentReciter = null;
    let isPlaying = false;
    let progressInterval = null;
    let fontSize = 2;
    let repeatMode = false;
    let currentAudioType = null;
    const audioInstances = {};
    let frenchVerses = [];

    // Navigation functions
    function showSection(sectionId) {
      document.getElementById(sectionId).classList.add('active');
      
      // Load content if needed
      if (sectionId === 'surah-page') loadSurahs();
      else if (sectionId === 'audio-page') loadAudioPage();
      else if (sectionId === 'french-page') loadFrenchSurahs();
    }
    
    function hideSection(sectionId) {
      document.getElementById(sectionId).classList.remove('active');
      stopAllAudios();
    }
    
    function backToList() {
      hideSection('surah-content');
      showSection('surah-page');
      stopAudio();
    }

    // Audio functions
    function navigateToAudioType(type) {
      currentAudioType = type;
      hideSection('audio-page');
      showSection('audio-surah-page');
      document.getElementById('audio-surah-title').textContent = `تلاوة ${type === 'murattal' ? 'مرتل' : type === 'mujawad' ? 'مجود' : 'حفص'}`;
      loadAudioSurahs();
    }

    async function loadAudioSurahs() {
      const audioSurahList = document.getElementById('audio-surah-list');
      audioSurahList.innerHTML = '<div class="col-span-full text-center py-8"><div class="loading-spinner"></div></div>';

      try {
        const response = await fetch('https://api.quran.com/api/v4/chapters?language=ar');
        const data = await response.json();

        audioSurahList.innerHTML = '';
        data.chapters.forEach(surah => {
          const surahElement = document.createElement('div');
          surahElement.className = 'audio-surah-item';
          surahElement.innerHTML = `
            <div class="flex items-center w-full gap-4" style="flex-direction: row;">
              <button onclick="toggleAudio(${surah.id}, this)" class="play-btn px-3 py-1 bg-green-600 text-white rounded" data-surah-id="${surah.id}">
                <i class="fas fa-play"></i>
              </button>
              <div class="progress-container-audio flex-1" onclick="seekAudio(event, ${surah.id})">
                <div class="progress-bar-audio" id="progress-bar-${surah.id}"></div>
              </div>
              <span id="current-time-${surah.id}" class="time-display">00:00</span>
              <div class="text-xl font-bold flex-1 text-right">${surah.name_arabic}</div>
            </div>
          `;
          audioSurahList.appendChild(surahElement);
        });
      } catch (error) {
        audioSurahList.innerHTML = '<div class="col-span-full text-center py-8 text-red-500">حدث خطأ في تحميل السور</div>';
      }
    }

    function toggleAudio(surahId, button) {
      // Stop other audios
      for (const id in audioInstances) {
        if (id != surahId && audioInstances[id]) {
          audioInstances[id].pause();
          audioInstances[id].currentTime = 0;
          const otherButton = document.querySelector(`button[data-surah-id="${id}"]`);
          if (otherButton) otherButton.innerHTML = '<i class="fas fa-play"></i>';
        }
      }

      if (audioInstances[surahId]) {
        if (!audioInstances[surahId].paused) {
          audioInstances[surahId].pause();
          if (button) button.innerHTML = '<i class="fas fa-play"></i>';
        } else {
          audioInstances[surahId].play().catch(e => {
            console.error('Erreur de lecture:', e);
            if (button) button.innerHTML = '<i class="fas fa-play"></i>';
          });
          if (button) button.innerHTML = '<i class="fas fa-pause"></i>';
        }
      } else {
        startAudio(surahId, button);
      }
    }
    
    function startAudio(surahId, button) {
      const audioUrl = getAudioUrl(surahId);
      const audio = new Audio(audioUrl);
      audioInstances[surahId] = audio;

      const currentTimeElement = document.getElementById(`current-time-${surahId}`);
      const progressBarElement = document.getElementById(`progress-bar-${surahId}`);

      if (!currentTimeElement || !progressBarElement) {
        console.error('Éléments du lecteur audio introuvables');
        return;
      }

      currentTimeElement.textContent = '00:00';
      progressBarElement.style.width = '0%';

      audio.addEventListener('loadedmetadata', () => {
        if (audio.duration !== Infinity) {
          // Metadata loaded
        }
      });

      audio.addEventListener('timeupdate', () => {
        updateAudioProgress(surahId);
      });

      audio.addEventListener('play', () => {
        if (button) button.innerHTML = '<i class="fas fa-pause"></i>';
        audio.progressInterval = setInterval(() => updateAudioProgress(surahId), 1000);
      });

      audio.addEventListener('pause', () => {
        if (button) button.innerHTML = '<i class="fas fa-play"></i>';
        clearInterval(audio.progressInterval);
      });

      audio.addEventListener('ended', () => {
        if (button) button.innerHTML = '<i class="fas fa-play"></i>';
        clearInterval(audio.progressInterval);
        document.getElementById(`progress-bar-${surahId}`).style.width = '0%';
        document.getElementById(`current-time-${surahId}`).textContent = '00:00';
      });

      audio.addEventListener('error', () => {
        if (button) button.innerHTML = '<i class="fas fa-play"></i>';
        clearInterval(audio.progressInterval);
        alert('حدث خطأ في تحميل الصوت. الرجاء المحاولة لاحقًا.');
      });

      audio.play().catch(e => {
        console.error('Playback failed:', e);
        if (button) button.innerHTML = '<i class="fas fa-play"></i>';
      });
    }

    function seekAudio(event, surahId) {
      if (!audioInstances[surahId]) return;
      
      const progressContainer = event.currentTarget;
      const width = progressContainer.clientWidth;
      const clickX = event.offsetX;
      const duration = audioInstances[surahId].duration;
      
      audioInstances[surahId].currentTime = (clickX / width) * duration;
    }

    function updateAudioProgress(surahId) {
      if (!audioInstances[surahId]) return;

      const audio = audioInstances[surahId];
      const progressBar = document.getElementById(`progress-bar-${surahId}`);
      
      if (!progressBar) return;

      if (!isNaN(audio.currentTime)) {
        document.getElementById(`current-time-${surahId}`).textContent = 
          formatTime(audio.currentTime);
      }

      if (!isNaN(audio.duration) && audio.duration > 0) {
        const progress = (audio.currentTime / audio.duration) * 100;
        progressBar.style.width = `${progress}%`;
      }
    }

    function stopAllAudios() {
      for (const surahId in audioInstances) {
        if (audioInstances[surahId]) {
          audioInstances[surahId].pause();
          clearInterval(audioInstances[surahId].progressInterval);
          document.getElementById(`progress-bar-${surahId}`).style.width = '0%';
          delete audioInstances[surahId];
        }
      }
      const buttons = document.querySelectorAll('.play-btn');
      buttons.forEach(btn => btn.innerHTML = '<i class="fas fa-play"></i>');
    }

    function getAudioUrl(surahId) {
      const surahNum = surahId.toString().padStart(3, '0');
      const baseUrl = 'https://ahmedaidara.github.io/ansar1.0/audio/hussary';
      
      switch(currentAudioType) {
        case 'murattal': return `${baseUrl}/murattal/${surahNum}.mp3`;
        case 'mujawad': return `${baseUrl}/mujawad/${surahNum}.mp3`;
        case 'hafs': return `${baseUrl}/hafs/${surahNum}.mp3`;
        default: return `${baseUrl}/murattal/${surahNum}.mp3`;
      }
    }

    // Quran reading functions
    async function loadSurahs() {
      const surahList = document.getElementById('surah-list');
      surahList.innerHTML = '<div class="col-span-full text-center py-8"><div class="loading-spinner"></div></div>';
      
      try {
        const response = await fetch('https://api.quran.com/api/v4/chapters?language=ar');
        const data = await response.json();
        
        surahList.innerHTML = '';
        data.chapters.forEach(surah => {
          const surahElement = document.createElement('div');
          surahElement.className = 'bg-white p-4 rounded-lg shadow-md text-center cursor-pointer hover:bg-[var(--primary-color)] hover:text-white transition';
          surahElement.innerHTML = `
            <div class="text-xl font-bold">${surah.name_arabic}</div>
            <div class="text-sm text-gray-600 mt-1">${surah.translated_name.name}</div>
            <div class="text-xs mt-2">${surah.verses_count} آيات</div>
          `;
          surahElement.onclick = () => showSurahContent(surah.id, surah.name_arabic);
          surahList.appendChild(surahElement);
        });
      } catch (error) {
        surahList.innerHTML = '<div class="col-span-full text-center py-8 text-red-500">حدث خطأ في تحميل السور</div>';
      }
    }

    async function showSurahContent(surahId, surahName) {
      hideSection('surah-page');
      showSection('surah-content');
      document.getElementById('surah-title').textContent = `سورة ${surahName}`;
      
      const surahText = document.getElementById('surah-text');
      surahText.innerHTML = '<div class="text-center py-12"><div class="loading-spinner"></div></div>';
      
      currentSurah = surahId;
      
      try {
        const response = await fetch(`https://api.quran.com/api/v4/quran/verses/uthmani?chapter_number=${surahId}`);
        const data = await response.json();
        
        let verses = data.verses.map(verse => verse.text_uthmani);
        
        if (surahId != 9) {
          verses.unshift('بِسْمِ اللَّهِ الرَّحْمَٰنِ الرَّحِيمِ');
        }
        
        surahText.innerHTML = verses.map((verse, index) => {
          if (index === 0 && surahId != 9) {
            return `<div class="bismillah">${verse}</div>`;
          } else {
            const verseNumber = surahId == 9 ? index + 1 : index;
            return `<div class="verse">${verse} <span class="verse-number">${verseNumber}</span></div>`;
          }
        }).join('');
        
        updateTextSize();
      } catch (error) {
        surahText.innerHTML = '<div class="text-center py-12 text-red-500">حدث خطأ في تحميل السورة</div>';
      }
    }

    // French Quran functions
    async function loadFrenchSurahs() {
      const surahList = document.getElementById('french-surah-list');
      surahList.innerHTML = '<div class="col-span-full text-center py-8"><div class="loading-spinner"></div></div>';

      try {
        // Load surah names
        const surahsResponse = await fetch('https://api.quran.com/api/v4/chapters?language=fr');
        const surahsData = await surahsResponse.json();

        // Load french text
        const frenchResponse = await fetch('fra-rashidmaash.txt');
        const frenchText = await frenchResponse.text();
        
        frenchVerses = frenchText.split('\n').map(line => {
          const [surah, verse, text] = line.split('|');
          return { surah: parseInt(surah), verse: parseInt(verse), text };
        });

        surahList.innerHTML = '';
        surahsData.chapters.forEach(surah => {
          const surahElement = document.createElement('div');
          surahElement.className = 'bg-white p-4 rounded-lg shadow-md text-center cursor-pointer hover:bg-[var(--primary-color)] hover:text-white transition';
          surahElement.innerHTML = `
            <div class="text-xl font-bold">${surah.name_complex}</div>
            <div class="text-sm text-gray-600 mt-1">${surah.translated_name.name}</div>
            <div class="text-xs mt-2">${surah.verses_count} versets</div>
          `;
          
          surahElement.addEventListener('click', () => {
            showFrenchSurahContent(surah.id, surah.name_complex);
          });
          
          surahList.appendChild(surahElement);
        });
      } catch (error) {
        surahList.innerHTML = '<div class="col-span-full text-center py-8 text-red-500">Erreur de chargement</div>';
      }
    }

    function showFrenchSurahContent(surahId, surahName) {
  hideSection('french-page');
  showSection('french-surah-content');
  
  // Ajoutez la Basmalah en français si ce n'est pas la sourate 9
  const basmalah = surahId !== 9 ? 
    '<div class="bismillah-french">Au nom d\'Allah, le Tout Miséricordieux, le Très Miséricordieux</div>' : 
    '';
  
  document.getElementById('french-surah-title').textContent = `Sourate ${surahName}`;
  
  const surahText = document.getElementById('french-surah-text');
  surahText.innerHTML = '<div class="text-center py-12"><div class="loading-spinner"></div></div>';

  // Filtrer les versets pour cette sourate
  const surahVerses = frenchVerses.filter(v => v.surah === surahId);
  
  // Générer le HTML avec la Basmalah si nécessaire
  let versesHtml = basmalah;
  
  surahVerses.forEach(verse => {
    versesHtml += `
      <div class="french-verse">
        <span class="french-verse-number">${verse.verse}</span>
        ${verse.text}
      </div>
    `;
  });
  
  surahText.innerHTML = versesHtml;
}

    // Utility functions
    function formatTime(seconds) {
      const mins = Math.floor(seconds / 60);
      const secs = Math.floor(seconds % 60);
      return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
    }
    
    function increaseTextSize() {
      if (fontSize < 3.5) {
        fontSize += 0.25;
        updateTextSize();
      }
    }
    
    function decreaseTextSize() {
      if (fontSize > 1.25) {
        fontSize -= 0.25;
        updateTextSize();
      }
    }
    
    function updateTextSize() {
      const surahText = document.getElementById('surah-text');
      if (surahText) surahText.style.fontSize = `${fontSize}rem`;
      
      const verses = document.querySelectorAll('.verse');
      verses.forEach(verse => {
        verse.style.fontSize = `${fontSize}rem`;
      });
      
      const bismillah = document.querySelector('.bismillah');
      if (bismillah) {
        bismillah.style.fontSize = `${fontSize * 1.2}rem`;
      }
    }

    function stopAudio() {
      if (currentAudio) {
        currentAudio.pause();
        currentAudio.currentTime = 0;
        currentAudio = null;
      }
      isPlaying = false;
      clearInterval(progressInterval);
    }

    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
      // Set initial text size
      updateTextSize();
    });
  </script>
</body>
</html>
